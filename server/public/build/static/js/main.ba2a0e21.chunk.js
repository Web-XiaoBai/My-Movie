(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{215:function(e,t,a){e.exports=a.p+"static/media/no.fa54d02e.jpg"},232:function(e,t,a){e.exports=a(478)},237:function(e,t,a){},238:function(e,t,a){},478:function(e,t,a){"use strict";a.r(t);var n,r=a(0),i=a.n(r),c=a(5),o=a.n(c),l=(a(237),a(238),a(52)),s=a(45),u=a(110),p=a(64),d=a(53),m={data:[],total:0,condition:{page:1,limit:10,key:""},isLoading:!1,totalPage:0},h=function(e,t){return Object(d.a)({},e,{data:t.payload.movie,total:t.payload.total,totalPage:Math.ceil(t.payload.total/e.condition.limit)})},f=function(e,t){var a=Object(d.a)({},e,{condition:Object(d.a)({},e.condition,{},t.payload)});return a.totalPage=Math.ceil(a.total/a.condition.limit),a},v=function(e,t){return Object(d.a)({},e,{isLoading:t.payload})},y=function(e,t){var a=e.data.filter((function(e){return e._id!==t.payload}));return Object(d.a)({},e,{data:a,total:e.total-1,totalPage:Math.ceil((e.total-1)/e.condition.limit)})},b=function(e,t){var a=e.data.find((function(e){return e._id===t.payload.id}));if(!a)return e;var n=Object(d.a)({},a);n[t.payload.type]=t.payload.newVal;var r=e.data.map((function(e){return e._id===t.payload.id?n:e}));return Object(d.a)({},e,{data:r})},g=Object(p.c)({movie:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"_setMovie":return h(e,t);case"_setCondition":return f(e,t);case"_setLoading":return v(e,t);case"_deleteMovie":return y(e,t);case"_checkedSwitch":return b(e,t);default:return e}}}),E=a(213),w=a.n(E),k=a(214),C=Object(p.d)(g,Object(p.a)(k.a,w.a)),j=a(26),x=a(27),O=a(34),S=a(32),I=a(35),M=function(e){function t(){return Object(j.a)(this,t),Object(O.a)(this,Object(S.a)(t).apply(this,arguments))}return Object(I.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){return i.a.createElement("h1",null,"\u6b22\u8fce\u4f7f\u7528\u7535\u5f71\u7ba1\u7406\u7cfb\u7edf")}}]),t}(i.a.Component),_=a(12),P=a.n(_),L=a(485),D=a(24),F=a(4),q=a(479),A=a(480),N=a(488),H=a(482),R=a(215),T=a.n(R);!function(e){e.isHot="isHot",e.isSoon="isSoon",e.isClassic="isClassic"}(n||(n={}));var z=function(e){function t(){return Object(j.a)(this,t),Object(O.a)(this,Object(S.a)(t).apply(this,arguments))}return Object(I.a)(t,e),Object(x.a)(t,[{key:"componentDidMount",value:function(){this.props.onLoad()}},{key:"getFliterDropdown",value:function(e){var t=this;return i.a.createElement("div",{style:{padding:8}},i.a.createElement(L.a,{placeholder:"\u8bf7\u8f93\u5165\u7535\u5f71\u540d\u79f0",value:this.props.condition.key,style:{width:188,marginBottom:8,display:"block"},onChange:function(e){return t.props.onKeyChange(e.target.value)},onPressEnter:this.props.onSearch}),i.a.createElement(D.a,{type:"primary",icon:"search",size:"small",onClick:this.props.onSearch,style:{width:90,marginRight:8}},"\u641c\u7d22"),i.a.createElement(D.a,{size:"small",style:{width:90},icon:"redo",onClick:function(){t.props.onKeyChange(""),t.props.onSearch()}},"\u91cd\u7f6e"))}},{key:"getColums",value:function(){var e=this;return[{title:"\u6d77\u62a5",dataIndex:"poster",render:function(e){return e?i.a.createElement("img",{className:"poster",src:e,alt:"\u6d77\u62a5\u56fe"}):i.a.createElement("img",{className:"poster",src:T.a,alt:"\u6682\u65e0\u56fe\u7247"})}},{title:"\u7535\u5f71\u540d\u79f0",dataIndex:"name",filterDropdown:function(t){return e.getFliterDropdown(t)},filterIcon:i.a.createElement(F.a,{type:"search"})},{title:"\u7c7b\u578b",dataIndex:"types",render:function(e){return e.join("\u4e28")}},{title:"\u5730\u533a",dataIndex:"areas",render:function(e){return e.join("\u4e28")}},{title:"\u65f6\u957f",dataIndex:"timing",render:function(e){return e+"\u5206\u949f"}},{title:"\u6b63\u5728\u70ed\u6620",dataIndex:"isHot",render:function(t,a){return i.a.createElement(q.a,{checked:t,onChange:function(t){e.props.onChangeSwitch(n.isHot,t,a._id)}})}},{title:"\u5373\u5c06\u4e0a\u7ebf",dataIndex:"isSoon",render:function(t,a){return i.a.createElement(q.a,{checked:t,onChange:function(t){e.props.onChangeSwitch(n.isSoon,t,a._id)}})}},{title:"\u7ecf\u5178\u5f71\u7247",dataIndex:"isClassic",render:function(t,a){return i.a.createElement(q.a,{checked:t,onChange:function(t){e.props.onChangeSwitch(n.isClassic,t,a._id)}})}},{title:"\u64cd\u4f5c",dataIndex:"_id",render:function(t){return i.a.createElement("div",null,i.a.createElement(l.b,{to:"/movie/edit/"+t},i.a.createElement(D.a,{size:"small",type:"primary"},"\u7f16\u8f91")),i.a.createElement(A.a,{title:"\u60a8\u786e\u5b9a\u8981\u5220\u9664\u6b64\u7535\u5f71\u5417?",onConfirm:function(){return P.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,P.a.awrap(e.props.onDelete(t));case 2:N.a.success("\u5220\u9664\u6210\u529f");case 3:case"end":return a.stop()}}))},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement(D.a,{size:"small",type:"danger"},"\u5220\u9664")))}}]}},{key:"handlePage",value:function(){return 0!==this.props.total&&{current:this.props.condition.page,pageSize:this.props.condition.limit,total:this.props.total}}},{key:"render",value:function(){var e=this;return i.a.createElement(H.a,{rowKey:"_id",columns:this.getColums(),dataSource:this.props.data,loading:this.props.isLoading,pagination:this.handlePage(),onChange:function(t){e.props.onChange(t)}})}}]),t}(r.Component),V=a(103),B=a(77),K=a.n(B),G=function(){function e(){Object(j.a)(this,e)}return Object(x.a)(e,null,[{key:"add",value:function(e){var t,a;return P.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,P.a.awrap(K.a.post("/api/movie",e));case 2:return t=n.sent,a=t.data,n.abrupt("return",a);case 5:case"end":return n.stop()}}))}},{key:"findById",value:function(e){var t,a;return P.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,P.a.awrap(K.a.get("/api/movie/"+e));case 2:return t=n.sent,a=t.data,n.abrupt("return",a);case 5:case"end":return n.stop()}}))}},{key:"find",value:function(e){var t,a;return P.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,P.a.awrap(K.a.get("/api/movie",{params:e}));case 2:return t=n.sent,a=t.data,n.abrupt("return",a);case 5:case"end":return n.stop()}}))}},{key:"updata",value:function(e,t){var a,n;return P.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,P.a.awrap(K.a.put("/api/movie/"+e,t));case 2:return a=r.sent,n=a.data,r.abrupt("return",n);case 5:case"end":return r.stop()}}))}},{key:"delete",value:function(e){var t,a;return P.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,P.a.awrap(K.a.delete("/api/movie/"+e));case 2:return t=n.sent,a=t.data,n.abrupt("return",a);case 5:case"end":return n.stop()}}))}}]),e}();function J(e,t){return{type:"_setMovie",payload:{movie:e,total:t}}}function U(e){return{type:"_setCondition",payload:e}}function Q(e){return{type:"_setLoading",payload:e}}function W(e){return{type:"_deleteMovie",payload:e}}function X(e,t,a){return{type:"_checkedSwitch",payload:{type:e,newVal:t,id:a}}}var Y={setMovieAction:J,setConditionAction:U,setLoadingAction:Q,deleteMovieAction:W,fetchMovies:function(e){return function(t,a){var n,r;return P.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return t(Q(!0)),t(U(e)),n=a().movie.condition,i.next=5,P.a.awrap(G.find(n));case 5:r=i.sent,t(J(r.data,r.total)),t(Q(!1));case 8:case"end":return i.stop()}}))}},deleteMovie:function(e){return function(t){return P.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t(Q(!0)),a.next=3,P.a.awrap(G.delete(e));case 3:t(W(e)),t(Q(!1));case 5:case"end":return a.stop()}}))}},checkedSwitchMovie:function(e,t,a){return function(n){return P.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return n(Q(!0)),r.next=3,P.a.awrap(G.updata(a,Object(V.a)({},e,t)));case 3:n(X(e,t,a)),n(Q(!1));case 5:case"end":return r.stop()}}))}}};var Z=Object(u.b)((function(e){return e.movie}),(function(e){return{onLoad:function(){e(Y.fetchMovies({page:1,limit:10,key:""}))},onChangeSwitch:function(t,a,n){e(Y.checkedSwitchMovie(t,a,n))},onDelete:function(t){return P.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,P.a.awrap(e(Y.deleteMovie(t)));case 2:case"end":return a.stop()}}))},onChange:function(t){e(Y.fetchMovies({page:t.current}))},onKeyChange:function(t){e(Y.setConditionAction({key:t}))},onSearch:function(){e(Y.fetchMovies({page:1}))}}}))(z),$=a(75),ee=a(484),te=a(487),ae=a(483),ne=a(486),re=function(e){function t(){var e,a;Object(j.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(O.a)(this,(e=Object(S.a)(t)).call.apply(e,[this].concat(r)))).state={isShow:!1},a}return Object(I.a)(t,e),Object(x.a)(t,[{key:"getUploadContent",value:function(){return this.props.value?null:i.a.createElement("div",null,i.a.createElement(F.a,{type:"plus"}),i.a.createElement("div",null,"\u4e0a\u4f20\u6587\u4ef6"))}},{key:"getFileList",value:function(){return this.props.value?[{uid:this.props.value,name:this.props.value,url:this.props.value}]:[]}},{key:"handleRequest",value:function(e){var t,a,n;return P.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return(t=new FormData).append(e.filename,e.file),a=new Request(e.action,{method:"post",body:t}),r.next=5,P.a.awrap(fetch(a).then((function(e){return e.json()})));case 5:(n=r.sent).error?N.a.error("\u4e0a\u4f20\u5931\u8d25\uff01"):this.props.onChange&&this.props.onChange(n.data);case 7:case"end":return r.stop()}}),null,this)}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(ae.a,{name:"imgfile",listType:"picture-card",accept:".jpg,.png,.gif",action:"/api/upload",fileList:this.getFileList(),customRequest:this.handleRequest.bind(this),onRemove:function(){return e.props.onChange&&e.props.onChange("")},onPreview:function(){e.setState({isShow:!0})}},this.getUploadContent()),i.a.createElement(ne.a,{visible:this.state.isShow,footer:null,onCancel:function(){e.setState({isShow:!1})}},i.a.createElement("img",{alt:"example",style:{width:"100%"},src:this.props.value})))}}]),t}(r.Component),ie=[{label:"\u5e7f\u5dde\u5929\u6cb3",value:"\u5e7f\u5dde\u5929\u6cb3"},{label:"\u5e7f\u5dde\u8d8a\u79c0",value:"\u5e7f\u5dde\u8d8a\u79c0"},{label:"\u5e7f\u5dde\u767d\u4e91",value:"\u5e7f\u5dde\u767d\u4e91"},{label:"\u5e7f\u5dde\u756a\u79ba",value:"\u5e7f\u5dde\u756a\u79ba"},{label:"\u5e7f\u5dde\u82b1\u90fd",value:"\u5e7f\u5dde\u82b1\u90fd"}],ce=$.a.Group,oe=[{label:"\u559c\u5267",value:"\u559c\u5267"},{label:"\u79d1\u5e7b",value:"\u79d1\u5e7b"},{label:"\u6050\u6016",value:"\u6050\u6016"},{label:"\u60ca\u609a",value:"\u60ca\u609a"},{label:"\u707e\u96be",value:"\u707e\u96be"},{label:"\u52a8\u4f5c",value:"\u52a8\u4f5c"},{label:"\u7231\u60c5",value:"\u7231\u60c5"}],le=$.a.Group,se=function(e){function t(){return Object(j.a)(this,t),Object(O.a)(this,Object(S.a)(t).apply(this,arguments))}return Object(I.a)(t,e),Object(x.a)(t,[{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),(0,this.props.form.validateFields)((function(e,a){var n;return P.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(e){r.next=5;break}return r.next=3,P.a.awrap(t.props.onSumbit(a));case 3:(n=r.sent)?N.a.error(n):N.a.success("\u63d0\u4ea4\u6210\u529f",1,(function(){t.props.history.push("/movie")}));case 5:case"end":return r.stop()}}))}))}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return i.a.createElement(ee.a,Object.assign({},{labelCol:{span:5},wrapperCol:{span:19}},{style:{width:"500px"},onSubmit:this.handleSubmit.bind(this)}),i.a.createElement(ee.a.Item,{label:"\u7535\u5f71\u540d\u79f0"},e("name",{rules:[{required:!0,message:"\u7535\u5f71\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a"}]})(i.a.createElement(L.a,null))),i.a.createElement(ee.a.Item,{label:"\u5c01\u9762\u6d77\u62a5"},e("poster")(i.a.createElement(re,null))),i.a.createElement(ee.a.Item,{label:"\u5730\u533a"},e("areas",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u4e0a\u6620\u5730\u533a"}]})(i.a.createElement(ce,{options:ie}))),i.a.createElement(ee.a.Item,{label:"\u7535\u5f71\u7c7b\u578b"},e("types",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u7535\u5f71\u7c7b\u578b"}]})(i.a.createElement(le,{options:oe}))),i.a.createElement(ee.a.Item,{label:"\u7535\u5f71\u65f6\u957f(\u5206)"},e("timing",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7535\u5f71\u65f6\u957f"}]})(i.a.createElement(te.a,{min:1,step:10}))),i.a.createElement(ee.a.Item,{label:"\u6b63\u5728\u70ed\u6620"},e("isHot",{initialValue:!1,valuePropName:"checked"})(i.a.createElement(q.a,{checkedChildren:i.a.createElement(F.a,{type:"check"}),unCheckedChildren:i.a.createElement(F.a,{type:"close"})}))),i.a.createElement(ee.a.Item,{label:"\u5373\u5c06\u4e0a\u6620"},e("isSoon",{initialValue:!1,valuePropName:"checked"})(i.a.createElement(q.a,{checkedChildren:i.a.createElement(F.a,{type:"check"}),unCheckedChildren:i.a.createElement(F.a,{type:"close"})}))),i.a.createElement(ee.a.Item,{label:"\u7ecf\u5178\u5f71\u7247"},e("isClassic",{initialValue:!1,valuePropName:"checked"})(i.a.createElement(q.a,{checkedChildren:i.a.createElement(F.a,{type:"check"}),unCheckedChildren:i.a.createElement(F.a,{type:"close"})}))),i.a.createElement(ee.a.Item,{label:"\u5f71\u7247\u63cf\u8ff0"},e("description")(i.a.createElement(L.a.TextArea,null))),i.a.createElement(ee.a.Item,Object.assign({},{wrapperCol:{span:19,offset:5}},{label:""}),i.a.createElement(D.a,{type:"primary",htmlType:"submit"},"\u63d0\u4ea4")))}}]),t}(r.Component);var ue=Object(s.e)(ee.a.create({mapPropsToFields:function(e){if(e.movie)return function(e){var t={};for(var a in e)t[a]=ee.a.createFormField({value:e[a]});return t}(e.movie)}})(se)),pe=function(e){function t(){return Object(j.a)(this,t),Object(O.a)(this,Object(S.a)(t).apply(this,arguments))}return Object(I.a)(t,e),Object(x.a)(t,[{key:"handleSumbit",value:function(e){var t;return P.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,P.a.awrap(G.add(e));case 2:if(!(t=a.sent).error){a.next=7;break}return a.abrupt("return",t.error);case 7:return a.abrupt("return","");case 8:case"end":return a.stop()}}))}},{key:"render",value:function(){return i.a.createElement(ue,{onSumbit:this.handleSumbit})}}]),t}(i.a.Component),de=function(e){function t(){var e,a;Object(j.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(O.a)(this,(e=Object(S.a)(t)).call.apply(e,[this].concat(r)))).state={movie:void 0},a}return Object(I.a)(t,e),Object(x.a)(t,[{key:"componentDidMount",value:function(){var e;return P.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,P.a.awrap(G.findById(this.props.match.params.id));case 2:(e=t.sent).data&&this.setState({movie:e.data});case 4:case"end":return t.stop()}}),null,this)}},{key:"handleSumbit",value:function(e){var t;return P.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,P.a.awrap(G.updata(this.props.match.params.id,e));case 2:if(!(t=a.sent).error){a.next=7;break}return a.abrupt("return",t.error);case 7:return a.abrupt("return","");case 8:case"end":return a.stop()}}),null,this)}},{key:"render",value:function(){return i.a.createElement(ue,{onSumbit:this.handleSumbit.bind(this),movie:this.state.movie})}}]),t}(i.a.Component),me=a(481),he=a(157),fe=me.a.Header,ve=me.a.Sider,ye=me.a.Content,be=function(){return i.a.createElement("div",{className:"container"},i.a.createElement(me.a,null,i.a.createElement(fe,{className:"header"},i.a.createElement(l.b,{to:"/"},"\u732b\u773c\u7535\u5f71\u7ba1\u7406\u7cfb\u7edf")),i.a.createElement(me.a,null,i.a.createElement(ve,null,i.a.createElement(he.a,{mode:"inline",theme:"dark"},i.a.createElement(he.a.Item,{key:"1"},i.a.createElement(l.b,{to:"/movie"},"\u7535\u5f71\u5217\u8868")),i.a.createElement(he.a.Item,{key:"2"},i.a.createElement(l.b,{to:"/movie/add"},"\u6dfb\u52a0\u7535\u5f71")))),i.a.createElement(ye,{className:"content"},i.a.createElement("div",null,i.a.createElement(s.a,{path:"/",component:M,exact:!0}),i.a.createElement(s.a,{path:"/movie",component:Z,exact:!0}),i.a.createElement(s.a,{path:"/movie/add",component:pe}),i.a.createElement(s.a,{path:"/movie/edit/:id",component:de}))))))},ge=function(){return i.a.createElement(u.a,{store:C},i.a.createElement(l.a,null,i.a.createElement(s.a,{path:"/",component:be})))};o.a.render(i.a.createElement(ge,null),document.getElementById("root"))}},[[232,1,2]]]);
//# sourceMappingURL=main.ba2a0e21.chunk.js.map